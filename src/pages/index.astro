---
import BaseLayout from "../layouts/BaseLayout.astro";

import Tagline from "../components/Content/Tagline.astro";
import ProjectCard from "../components/Card/ProjectCard.astro";
import TagBar from "../components/Tag/TagBar.astro";

import { getCollection } from "astro:content";
//import {filterProjects} from "../scripts/filter.js"

const allProjects = await getCollection("projects",);

---

<BaseLayout>
  <div class="page-home">
    <Tagline/>
    <div class="container tag-home">
      <TagBar/>
    </div>
    <div class="work-display clearfix">
      <div class="grid">
        {allProjects.map((projects) => 
            <ProjectCard
                url={`/projects/${projects.slug}/`} 
                img={projects.data.image.url} 
                alt={projects.data.image.alt} 
                description={projects.data.card} 
                collab={projects.data.made} 
                title={projects.data.title} />
        )}
      </div>  
    </div>
  </div>
  <script>
    function hideBlogs(evt) {
      let selectedTag = evt.currentTarget.getAttribute("data-type");
      let tagElement = document.getElementById("tags");
      let tags = tagElement.dataset.tags;
      tags = tags.split(",");
      tags.splice(tags.indexOf(selectedTag), 1);

      tags.forEach((t) => {
        const elementsToHide = document.getElementsByClassName(t);
        for (let i = 0; i < elementsToHide.length; i++) {
          elementsToHide[i].style.display = "none";
        }
    });

    let elementsToShow = document.getElementsByClassName(selectedTag);
    for (let i = 0; i < elementsToShow.length; i++) {
      elementsToShow[i].style.display = "block";
    }
  }

  // Event listener for the button click
  const input = document.querySelectorAll("#blogFilter");
  input.forEach((e) => {
    e.addEventListener("click", hideBlogs);
  });
  </script>
</BaseLayout>